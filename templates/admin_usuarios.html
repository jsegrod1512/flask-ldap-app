{% extends "base.html" %}
{% block title %}Gestión de Usuarios{% endblock %}
{% block content %}
<div class="row justify-content-center">
  <div class="col-md-8">
    <h3 class="mb-4">Dar de Alta Usuarios LDAP en la App</h3>
    {% if pending %}
      <form method="post">
        <!-- Selector de rol -->
        <div class="mb-4">
          <label for="role_id" class="form-label">Asignar Rol:</label>
          <select id="role_id" name="role_id" class="form-select" required>
            <option value="1">Administrador</option>
            <option value="2">Desarrollador</option>
            <option value="3" selected>Cliente</option>
          </select>
        </div>
        <!-- Tabla de usuarios pendientes -->
        <table class="table table-striped">
          <thead>
            <tr>
              <th scope="col"><input type="checkbox" id="select-all"></th>
              <th scope="col">Usuario (uid)</th>
            </tr>
          </thead>
          <tbody>
            {% for uid in pending %}
            <tr>
              <td>
                <input type="checkbox" name="uids" value="{{ uid }}">
              </td>
              <td>{{ uid }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        <button type="submit" class="btn btn-success">
          Dar de Alta Seleccionados
        </button>
      </form>
    {% else %}
      <div class="alert alert-info">
        No hay usuarios pendientes de alta.
      </div>
    {% endif %}
  </div>
</div>

<script>
// Checkbox “Seleccionar todo”
document.getElementById('select-all').addEventListener('change', function(e){
  document.querySelectorAll('input[name="uids"]').forEach(cb => {
    cb.checked = e.target.checked;
  });
});
</script>
{% endblock %}
